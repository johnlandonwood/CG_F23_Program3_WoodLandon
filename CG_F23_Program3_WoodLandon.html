<!DOCTYPE html>
<html>

<script id="vertex-shader" type="x-shader/x-vertex">
#version 300 es

in vec4 aPosition;
in vec2 aTexCoord;

out vec2 vTexCoord;

void main() { 
    gl_Position = aPosition;
    vTexCoord = aTexCoord;
}
</script>

<script id="normal-fragment-shader" type="x-shader/x-fragment">
#version 300 es

precision mediump float;

in vec2 vTexCoord;
uniform sampler2D texturevid;

out vec4 fColor;

void main() {
    fColor = vec4( texture( texturevid, vTexCoord ).rgb, 1. );
}
</script>

<script id="inversion-fragment-shader" type ="x-shader/x-fragment">
#version 300 es

precision mediump float;

in vec2 vTexCoord;
uniform sampler2D texturevid;

out vec4 fColor;

void main() {
    vec4 texColor = texture(texturevid, vTexCoord);
    
    // Invert the colors by subtracting each color component from 1.0
    vec3 invertedColor = vec3(1.0) - texColor.rgb;
    
    // Create the final color by combining alpha and inverted RGB
    fColor = vec4(invertedColor, texColor.a);
}
</script>

<script id="digital-halftoning-fragment-shader" type ="x-shader/x-fragment">
#version 300 es

precision mediump float;

in vec2 vTexCoord;
uniform sampler2D texturevid;

out vec4 fColor;

void main() {
    vec4 texColor = texture(texturevid, vTexCoord);
    
    // Convert color to grayscale using luminance (you can use other methods for grayscale conversion)
    float gray = dot(texColor.rgb, vec3(0.2126, 0.7152, 0.0722));
    
    // Threshold-based halftoning: if grayscale value > 0.5, set to white; otherwise, set to black
    float threshold = 0.5;
    float halftoneValue = step(threshold, gray);
    
    // Output black or white depending on the halftoneValue
    fColor = vec4(vec3(halftoneValue), texColor.a);
}    
</script>

<video id="webcamVideo" style="display: none;"></video>

<body>
    <canvas id="gl-canvas" width="700" height="700"> </canvas> 
    <br/>
    <p>Select fragment shader effect: </p>
    <select id="shaderSelector">
        <option value="0" selected="selected">No effect</option>
        <option value="1">Inversion Shader</option>
        <option value="2">Digital Halftoning Shader</option>
    </select>
</body>

<script src="../Common/initShaders.js"></script>
<script type="text/javascript" src="CG_F23_Program3_WoodLandon.js"></script>

